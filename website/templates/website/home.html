{% extends 'website/base.html' %}
{% load static %}

{% block title %}Home - Fieldmax | Premium Tech at Unbeatable Prices{% endblock %}

{% block content %}
<style>
  /* Reset and global styles */
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    outline: none;
  }

  /* Sections spacing to prevent overlaps */
  section {
    margin-bottom: 60px;
  }

  /* ===== MODERN GRADIENT BACKGROUND ===== */
  .gradient-bg {
    position: fixed;
    inset: 0;
    z-index: -1;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #00f2fe 100%);
    background-size: 400% 400%;
    animation: gradientShift 20s ease infinite;
  }
  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  .gradient-bg::before {
    content: '';
    position: absolute;
    inset: 0;
    background: 
      radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 0%, transparent 50%),
      radial-gradient(circle at 80% 80%, rgba(255,255,255,0.08) 0%, transparent 50%),
      radial-gradient(circle at 40% 20%, rgba(255,255,255,0.06) 0%, transparent 50%);
    animation: pulse 6s ease-in-out infinite;
  }
  @keyframes pulse {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 1; }
  }

  /* ===== FLOATING PARTICLES ===== */
  .particles {
    position: fixed;
    inset: 0;
    z-index: -1;
    pointer-events: none;
    overflow: hidden;
  }
  .particle {
    position: absolute;
    background: rgba(255,255,255,0.4);
    border-radius: 50%;
  }

  /* ===== VIDEO BACKGROUND ===== */
  .video-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -2;
    overflow: hidden;
  }
  .video-background video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0.25;
    filter: blur(2px);
  }
  .video-background::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(180deg, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0.6) 100%);
  }

  /* ===== HERO SECTION ===== */
  .hero {
    position: relative;
    min-height: 35vh;
    display: flex;
    align-items: center;
    padding: 50px 5%;
    color: #0771bdcc;
    overflow: hidden;
    z-index: 1;
  }
  .hero-content {
    max-width: 1400px;
    width: 100%;
    margin: 0 auto;
  }
  .hero-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 40px;
    align-items: center;
  }

  /* HERO TEXT SIDE */
  .hero-text {
    animation: fadeInUp 1s ease;
    position: relative;
    z-index: 2;
  }
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(40px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(20px);
    padding: 8px 16px;
    border-radius: 50px;
    font-size: 8px;
    font-weight: 500;
    letter-spacing: 1px;
    border: 1px solid rgba(255,255,255,0.3);
    margin-bottom: 20px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    animation: glow 3s ease-in-out infinite;
  }
  @keyframes glow {
    0%, 100% { box-shadow: 0 0 20px rgba(255,255,255,0.3), 0 8px 32px rgba(0,0,0,0.1); }
    50% { box-shadow: 0 0 40px rgba(249, 2, 2, 0.6), 0 8px 32px rgba(0,0,0,0.2); }
  }
  .hero-badge .badge-icon {
    animation: rotate 3s linear infinite;
    font-size: 12px;
  }
  @keyframes rotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .hero-title {
    font-size: clamp(30px, 5vw, 60px);
    font-weight: 900;
    line-height: 1.1;
    margin-bottom: 20px;
    letter-spacing: -2px;
    text-shadow: 0 10px 30px rgba(0,0,0,0.3);
  }
  .hero-title .highlight {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    display: block;
    animation: shimmer 4s ease-in-out infinite;
    position: relative;
  }
  @keyframes shimmer {
    0%, 100% { filter: brightness(1) hue-rotate(0deg); }
    50% { filter: brightness(1.4) hue-rotate(10deg); }
  }

  .hero-subtitle {
    font-size: 16px;
    line-height: 1.6;
    opacity: 0.95;
    margin-bottom: 30px;
    max-width: 500px;
    text-shadow: 0 2px 10px rgba(0,0,0,0.2);
  }

  .hero-buttons {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
  }
  .btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 12px 24px;
    border-radius: 50px;
    font-weight: 600;
    font-size: 14px;
    text-decoration: none;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border: none;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  .btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
    transform: translateX(-100%);
    transition: transform 0.6s ease;
  }
  .btn:hover::before {
    transform: translateX(100%);
  }

  .btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: #f40606;
    box-shadow: 0 20px 40px rgba(5, 47, 233, 0.4);
  }
  .btn-primary:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 30px 60px rgba(102, 126, 234, 0.6);
  }

  .btn-secondary {
    background: rgba(255,255,255,0.15);
    color: #0703ee;
    border: 2px solid rgba(237, 7, 237, 0.4);
    backdrop-filter: blur(20px);
  }
  .btn-secondary:hover {
    background: rgba(255,255,255,0.25);
    border-color: rgba(243, 6, 215, 0.6);
    transform: translateY(-5px);
  }

  /* ===== SLIDESHOW ===== */
  .hero-slideshow {
    position: relative;
    width: 100%;
    height: 400px;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 30px 60px rgba(0,0,0,0.4);
    animation: fadeInRight 1.2s ease;
    border: 2px solid rgba(255,255,255,0.2);
  }
  @keyframes fadeInRight {
    from { opacity: 0; transform: translateX(60px); }
    to { opacity: 1; transform: translateX(0); }
  }
  .slideshow-container {
    position: relative;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.3);
    backdrop-filter: blur(30px);
  }
  .slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 25px;
  }
  .slide.active {
    opacity: 1;
    z-index: 2;
  }
  .slide img {
    max-width: 90%;
    max-height: 90%;
    object-fit: contain;
    border-radius: 15px;
    filter: drop-shadow(0 20px 40px rgba(0,0,0,0.4));
    transition: transform 0.4s ease;
  }
  .slide:hover img {
    transform: scale(1.05);
  }
  /* Navigation Arrows */
  .slideshow-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(20px);
    border: 2px solid rgba(255,255,255,0.3);
    color: #0824f9;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 18px;
    transition: all 0.3s ease;
    z-index: 10;
  }
  .slideshow-arrow:hover {
    background: rgba(255,255,255,0.3);
    transform: translateY(-50%) scale(1.15);
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
  }
  .slideshow-arrow.prev { left: 15px; }
  .slideshow-arrow.next { right: 15px; }

  /* Dots */
  .slideshow-dots {
    position: absolute;
    bottom: 15px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
    z-index: 10;
  }
  .dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: rgba(255,255,255,0.4);
    cursor: pointer;
    transition: all 0.3s ease;
    border: 2px solid rgba(255,255,255,0.6);
  }
  .dot.active {
    background: #06f0d1;
    transform: scale(1.4);
    box-shadow: 0 0 15px rgba(19, 8, 8, 0.9);
  }
  .dot:hover {
    background: rgba(26, 2, 242, 0.7);
    transform: scale(1.2);
  }

  /* ===== SCROLL INDICATOR ===== */
  .scroll-indicator {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    width: 25px;
    height: 45px;
    border: 3px solid rgba(14, 2, 2, 0.6);
    border-radius: 15px;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    padding-top: 6px;
    cursor: pointer;
    animation: bounce 2.5s infinite;
    transition: all 0.3s ease;
  }
  .scroll-indicator:hover {
    border-color: #180cfc;
    transform: translateX(-50%) scale(1.1);
  }
  .scroll-indicator::after {
    content: '';
    display: block;
    width: 4px;
    height: 4px;
    background: #fc0606;
    border-radius: 50%;
    animation: scrollDown 2.5s infinite;
  }
  @keyframes bounce {
    0%, 100% { transform: translateX(-50%) translateY(0); }
    50% { transform: translateX(-50%) translateY(12px); }
  }
  @keyframes scrollDown {
    0%, 100% { transform: translateY(0); opacity: 1; }
    50% { transform: translateY(12px); opacity: 0.3; }
  }

  
  /* ===== MARQUEE ===== */
  .marquee-container {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    overflow: hidden;
    background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
    border-top: 2px solid rgba(255,255,255,0.3);
    border-bottom: 2px solid rgba(255,255,255,0.3);
    padding: 15px 0;
    z-index: 5;
    box-shadow: 0 -10px 30px rgba(0,0,0,0.3);
  }
  .marquee {
    display: flex;
    animation: scroll 40s linear infinite;
    white-space: nowrap;
  }
  .marquee-content {
    display: flex;
    align-items: center;
    gap: 50px;
    padding-right: 50px;
  }
  .marquee-item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 16px;
    font-weight: 900;
    color: #fff;
    text-transform: uppercase;
    letter-spacing: 1px;
    text-shadow: 0 2px 10px rgba(0,0,0,0.3);
  }
  .marquee-icon {
    font-size: 24px;
    animation: iconBounce 2s ease-in-out infinite;
  }
  @keyframes scroll {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }
  @keyframes iconBounce {
    0%, 100% { transform: translateY(0) scale(1); }
    50% { transform: translateY(-8px) scale(1.05); }
  }



  /* ===== STATS SECTION ===== */
  .stats {
    position: relative;
    padding: 70px 5%;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(30px);
  }
  .stats-grid {
    max-width: 1600px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 25px;
  }
  .stat-item {
    text-align: center;
    padding: 30px 20px;
    background: rgba(255,255,255,0.08);
    border: 2px solid rgba(255,255,255,0.15);
    border-radius: 20px;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    backdrop-filter: blur(20px);
  }
  .stat-item:hover {
    transform: translateY(-10px) scale(1.03);
    background: rgba(255,255,255,0.15);
    border-color: rgba(255,255,255,0.4);
    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
  }
  .stat-number {
    font-size: 40px;
    font-weight: 900;
    background: linear-gradient(135deg, #fff, #f093fb);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    display: block;
    margin-bottom: 10px;
    text-shadow: 0 3px 8px rgba(0,0,0,0.2);
  }
  .stat-label {
    font-size: 14px;
    opacity: 0.9;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: #fff;
  }


  /* ===== PRODUCTS SECTION - UPDATED ===== */
  .product-item {
    min-width: 320px;
    background: rgba(255,255,255,0.08);
    backdrop-filter: blur(30px);
    border: 2px solid rgba(255,255,255,0.15);
    border-radius: 20px;
    overflow: hidden;
    scroll-snap-align: start;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    cursor: pointer;
    display: flex;
    flex-direction: column;
  }
  
  .product-img {
    width: 100%;
    height: 250px;
    position: relative;
    background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
    overflow: hidden;
  }
  
  .product-img img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease, filter 0.3s ease;
    filter: brightness(0.95);
  }
  
  .product-item:hover .product-img img {
    transform: scale(1.15);
    filter: brightness(1);
  }
  
  .product-img-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: rgba(255,255,255,0.8);
  }
  
  .product-img-placeholder i {
    font-size: 4rem;
    opacity: 0.5;
    margin-bottom: 0.75rem;
  }
  
  .product-img-placeholder span {
    font-size: 0.9rem;
    font-weight: 600;
  }
  
  .image-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(to bottom, transparent, rgba(0,0,0,0.4));
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  
  .product-item:hover .image-overlay {
    opacity: 1;
  }
  
  .product-badges-container {
    position: absolute;
    top: 1rem;
    left: 1rem;
    right: 1rem;
    display: flex;
    justify-content: space-between;
    z-index: 2;
  }
  
  .product-badge {
    padding: 6px 12px;
    border-radius: 15px;
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.3);
    backdrop-filter: blur(10px);
  }
  
  .status-badge {
    background: linear-gradient(135deg, #10b981, #059669);
    color: #fff;
  }
  
  .status-badge.lowstock {
    background: linear-gradient(135deg, #f59e0b, #d97706);
  }
  
  .status-badge.outofstock {
    background: linear-gradient(135deg, #ef4444, #dc2626);
  }
  
  .single-item-badge {
    background: linear-gradient(135deg, #f093fb, #f5576c);
    color: #fff;
  }
  
  .product-info-content {
    padding: 25px;
    display: flex;
    flex-direction: column;
    flex: 1;
  }
  
  .product-code {
    font-size: 12px;
    color: rgba(255,255,255,0.7);
    margin-bottom: 8px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 5px;
  }
  
  .product-item h4 {
    font-size: 18px;
    font-weight: 900;
    margin-bottom: 12px;
    color: #fff;
    letter-spacing: -0.5px;
    line-height: 1.3;
  }
  
  .price {
    font-size: 24px;
    font-weight: 900;
    background: linear-gradient(135deg, #fff, #f093fb);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 15px;
    display: block;
  }
  
  .product-actions {
    margin-top: auto;
  }
  
  .btn-add-cart {
    width: 100%;
    padding: 12px 20px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: #fff;
    border: none;
    border-radius: 50px;
    font-weight: 700;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  
  .btn-add-cart:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
  }
  
  .btn-add-cart:disabled {
    background: linear-gradient(135deg, #6b7280, #4b5563);
    cursor: not-allowed;
    opacity: 0.6;
  }



  /* ===== FLOATING ACTION BUTTON ===== */
  .fab {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-size: 20px;
    cursor: pointer;
    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.5);
    transition: all 0.3s ease;
    z-index: 1000;
    animation: pulse 2s infinite;
  }
  .fab:hover {
    transform: scale(1.15);
    box-shadow: 0 15px 30px rgba(102, 126, 234, 0.7);
  }

  /* ===== TOAST NOTIFICATION ===== */
  .toast {
    position: fixed;
    bottom: 80px;
    right: 20px;
    background: rgba(255,255,255,0.95);
    backdrop-filter: blur(20px);
    padding: 15px 20px;
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    color: #333;
    font-weight: 700;
    transform: translateX(400px);
    transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    z-index: 1001;
    border: 2px solid rgba(102, 126, 234, 0.3);
  }
  .toast.show {
    transform: translateX(0);
  }

  /* ===== LOADING STATE ===== */
  .loading {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 30px;
    color: #fff;
    font-size: 14px;
  }
  .loading::after {
    content: '...';
    animation: dots 1.5s steps(4, end) infinite;
  }
  @keyframes dots {
    0%, 20% { content: '.'; }
    40% { content: '..'; }
    60%, 100% { content: '...'; }
  }

  /* ===== RESPONSIVE ===== */
  @media(max-width: 1024px) {
    .hero {
      min-height: 30vh;
    }
    .hero-title {
      font-size: 24px;
    }
    .hero-subtitle {
      font-size: 14px;
    }
    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    .features-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  @media(max-width: 768px) {
    .hero {
      min-height: 28vh;
      padding: 40px 5% 50px;
    }
    .hero-title {
      font-size: 20px;
    }
    .hero-subtitle {
      font-size: 14px;
    }
    .stat-number {
      font-size: 30px;
    }
    .section-header h2 {
      font-size: 18px;
      margin-bottom: 12px;
    }
    .feature-card {
      padding: 30px 20px;
    }
    .product-item {
      min-width: 250px;
    }
    .product-img {
      height: 150px;
      font-size: 50px;
    }
    .fab {
      bottom: 15px;
      right: 15px;
      width: 45px;
      height: 45px;
      font-size: 18px;
    }
  }
</style>

<!-- Video Background -->
<div class="video-background">
  <video autoplay muted loop playsinline>
    <source src="{% static 'videos/SHOPVIEW.mp4' %}" type="video/mp4" />
  </video>
</div>

<!-- Gradient Background -->
<div class="gradient-bg"></div>

<!-- Particles -->
<div class="particles" id="particles"></div>

<!-- Hero Section -->
<section class="hero" id="home">
  <div class="hero-content">
    <div class="hero-grid">
      <!-- Text Side -->
      <div class="hero-text">
        <div class="hero-badge">
          <span class="badge-icon">‚ö°</span>
          <span>BEST PRICES GUARANTEED</span>
        </div>
        <h1 class="hero-title">
          PREMIUM TECH <br />
          <span class="highlight">AMAZING PRICES</span>
        </h1>
        <p class="hero-subtitle">
          Discover the latest smartphones, accessories, and cutting-edge gadgets at unbeatable prices. Shop with confidence and enjoy exclusive deals on premium brands.
        </p>
        <div class="hero-buttons">
          <a href="#products" class="btn btn-primary">
            <span>üõçÔ∏è</span>
            <span>SHOP NOW</span>
          </a>
          <a href="#features" class="btn btn-secondary">
            <span>üî•</span>
            <span>HOT DEALS</span>
          </a>
        </div>
      </div>
      <!-- Slideshow Side -->
      <div class="hero-slideshow">
        <div class="slideshow-container">
          <div class="slide active">
            <img src="{% static 'images/NOKIA.jpg' %}" alt="Nokia Premium Phone" loading="lazy" />
          </div>
          <div class="slide">
            <img src="{% static 'images/TECNO.jpg' %}" alt="Tecno Smartphone" loading="lazy" />
          </div>
          <div class="slide">
            <img src="{% static 'images/OKING.jpg' %}" alt="Oking Phone" loading="lazy" />
          </div>
          <div class="slide">
            <img src="{% static 'images/ITEL.jpg' %}" alt="Itel Device" loading="lazy" />
          </div>
          <div class="slide">
            <img src="{% static 'images/NG.png' %}" alt="Screen Protector" loading="lazy" />
          </div>
          <div class="slide">
            <img src="{% static 'images/21D.jpg' %}" alt="21D Protector" loading="lazy" />
          </div>
          <!-- Navigation Arrows -->
          <div class="slideshow-arrow prev" onclick="changeSlide(-1)">‚ùÆ</div>
          <div class="slideshow-arrow next" onclick="changeSlide(1)">‚ùØ</div>
          <!-- Dots -->
          <div class="slideshow-dots">
            <span class="dot active" onclick="currentSlide(0)"></span>
            <span class="dot" onclick="currentSlide(1)"></span>
            <span class="dot" onclick="currentSlide(2)"></span>
            <span class="dot" onclick="currentSlide(3)"></span>
            <span class="dot" onclick="currentSlide(4)"></span>
            <span class="dot" onclick="currentSlide(5)"></span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Scroll Indicator -->
  <div class="scroll-indicator" onclick="document.getElementById('stats').scrollIntoView({behavior: 'smooth'});"></div>
  <!-- Animated Marquee -->
  <div class="marquee-container">
    <div class="marquee">
      <div class="marquee-content">
        <div class="marquee-item"><span class="marquee-icon">üì±</span> <span>SMARTPHONES</span></div>
        <div class="marquee-item"><span class="marquee-icon">üéß</span> <span>HEADPHONES</span></div>
        <div class="marquee-item"><span class="marquee-icon">‚åö</span> <span>SMARTWATCHES</span></div>
        <div class="marquee-item"><span class="marquee-icon">üíª</span> <span>LAPTOPS</span></div>
        <div class="marquee-item"><span class="marquee-icon">üì∑</span> <span>CAMERAS</span></div>
        <div class="marquee-item"><span class="marquee-icon">üéÆ</span> <span>GAMING</span></div>
        <div class="marquee-item"><span class="marquee-icon">üîã</span> <span>ACCESSORIES</span></div>
        <div class="marquee-item"><span class="marquee-icon">‚ö°</span> <span>FAST DELIVERY</span></div>
      </div>
      <div class="marquee-content" aria-hidden="true">
        <div class="marquee-item"><span class="marquee-icon">üì±</span> <span>SMARTPHONES</span></div>
        <div class="marquee-item"><span class="marquee-icon">üéß</span> <span>HEADPHONES</span></div>
        <div class="marquee-item"><span class="marquee-icon">‚åö</span> <span>SMARTWATCHES</span></div>
        <div class="marquee-item"><span class="marquee-icon">üíª</span> <span>LAPTOPS</span></div>
        <div class="marquee-item"><span class="marquee-icon">üì∑</span> <span>CAMERAS</span></div>
        <div class="marquee-item"><span class="marquee-icon">üéÆ</span> <span>GAMING</span></div>
        <div class="marquee-item"><span class="marquee-icon">üîã</span> <span>ACCESSORIES</span></div>
        <div class="marquee-item"><span class="marquee-icon">‚ö°</span> <span>FAST DELIVERY</span></div>
      </div>
    </div>
  </div>
</section>

<!-- Stats Section -->
<section class="stats" id="stats">
  <div class="stats-grid">
    <div class="stat-item">
      <span class="stat-number" data-target="0" id="stat-products">100K+</span>
      <span class="stat-label">Products</span>
    </div>
    <div class="stat-item">
      <span class="stat-number" data-target="0" id="stat-customers">100K+</span>
      <span class="stat-label">Customers</span>
    </div>
    <div class="stat-item">
      <span class="stat-number" data-target="0" id="stat-satisfaction">100%</span>
      <span class="stat-label">Satisfaction</span>
    </div>
    <div class="stat-item">
      <span class="stat-number">24/7</span>
      <span class="stat-label">Support</span>
    </div>
    <div class="stat-item">
      <span class="stat-number" data-target="0" id="stat-caredesk">0722 558 544</span>
      <span class="stat-label">Care Desk</span>
    </div>
  </div>
</section>




<!-- MOST FREQUENTLY SOLD ITEMS -->
<section class="products" id="top-selling-products">
  <div class="section-header" style="text-align: center; margin-bottom: 20px;">
    <h2 style="color: red; font-size: 2rem; font-weight: bold;">BEST SELLING ITEMS</h2>
    <p style="color: rgb(0, 30, 255); font-size: 1.2rem;">Quality Products to our valued clients</p>
  </div>
  <div class="products-scroll" style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: center;">
    {% if featured_products %}
      {% for product in featured_products %}
        <div class="product-item" style="width: 220px; background: rgba(255,255,255,0.08); border-radius: 12px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: flex; flex-direction: column; cursor: pointer;">
          
          <!-- Product Image -->
          <div class="product-img" style="height: 150px; overflow: hidden; position: relative;">
            {% if product.image %}
              <img src="{{ product.image.url }}" alt="{{ product.name }}" loading="lazy" style="width: 100%; height: 100%; object-fit: cover;" onerror="this.parentElement.innerHTML='<div class=\'product-img-placeholder\'><i class=\'bi bi-image\'></i><span>Image Not Available</span></div>'"/>
              <div class="image-overlay"></div>
            {% else %}
              <div class="product-img-placeholder" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #667eea, #764ba2); color: rgba(255,255,255,0.8); flex-direction: column;">
                <i class="bi bi-image" style="font-size: 2.5rem; margin-bottom: 0.5rem;"></i>
                <span>No Image</span>
              </div>
            {% endif %}
            <!-- Badges -->
            <div style="position: absolute; top: 10px; left: 10px; display: flex; gap: 5px; z-index: 2;">
              <span class="product-badge status-badge {{ product.status }}" style="padding: 3px 8px; border-radius: 12px; font-size: 8px; font-weight: 700; background: linear-gradient(135deg, #10b981, #059669); color: #fff;">
                {{ product.get_status_display }}
              </span>
              {% if product.category.is_single_item %}
                <span class="product-badge" style="padding: 3px 8px; border-radius: 12px; font-size: 8px; font-weight: 700; background: linear-gradient(135deg, #f093fb, #f5576c); color: #fff;">SINGLE ITEM</span>
              {% endif %}
            </div>
          </div>
          
          <!-- Product Info -->
          <div style="padding: 10px; display: flex; flex-direction: column; flex: 1; color: #000;">
            <div style="font-size: 12px; color: #222; margin-bottom: 4px;"><i class="bi bi-upc"></i> {{ product.product_code }}</div>
            <h4 style="font-size: 16px; font-weight: 700; margin-bottom: 8px; color: #111; line-height: 1.2;">{{ product.name }}</h4>
            <div class="price" style=" font-size: 20px; font-weight: 900; background: #fff; -webkit-background-clip: text; background-clip: text; /* Add this for compatibility */-webkit-text-fill-color: #000;  margin-bottom: 12px;">KSh {{ product.selling_price|floatformat:0 }}</div>
            <!-- Add to Cart Button -->
            <div style="margin-top: auto;">
              {% if product.status == 'available' or product.status == 'lowstock' %}
                <button class="btn-add-cart" style="width: 100%; padding: 10px; background: linear-gradient(135deg, #667eea, #764ba2); color: #fff; border: none; border-radius: 25px; font-weight: 600; font-size: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px;"
                        data-product-id="{{ product.id }}"
                        data-product-name="{{ product.name }}"
                        data-product-price="{{ product.selling_price }}"
                        data-product-code="{{ product.product_code }}"
                        data-product-image="{{ product.image.url }}"
                        data-max-quantity="{{ product.quantity }}"
                        onclick="event.stopPropagation(); addToCart(this)">
                  <i class="bi bi-cart-plus"></i> <span>ADD TO CART</span>
                </button>
              {% else %}
                <button class="btn-add-cart" disabled style="width: 100%; padding: 10px; background: #6b7280; border-radius: 25px; font-weight: 600; font-size: 14px; cursor: not-allowed; display: flex; align-items: center; justify-content: center; gap: 8px;">
                  <i class="bi bi-inbox"></i> {{ product.get_status_display|upper }}
                </button>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p style="color:#fff; text-align:center;">No popular products available</p>
    {% endif %}
  </div>
</section>


<!-- Floating Action Button -->
<div class="fab" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" title="Back to Top">‚Üë</div>

<!-- Toast Notification -->
<div class="toast" id="toast">
  <span id="toastMessage"></span>
</div>
</style>





<!-- JavaScript Section -->
<script>
  // CSRF token for Django
  function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
      const cookies = document.cookie.split(';');
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.substring(0, name.length + 1) === (name + '=')) {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
          break;
        }
      }
    }
    return cookieValue;
  }
  const csrftoken = getCookie('csrftoken');

  // Load products from API
  async function loadProducts() {
    try {
      const response = await fetch('/api/featured-products/');
      const data = await response.json();
      if (data.success && data.products.length > 0) {
        renderProducts(data.products);
      } else {
        showError('No products available at the moment');
      }
    } catch (error) {
      showError('Failed to load products');
      console.error(error);
    }
  }

  function renderProducts(products) {
    const container = document.getElementById('productsContainer');
    if (products.length === 0) {
      container.innerHTML = '<p style="color: #fff; text-align: center; width: 100%;">No products available</p>';
      return;
    }

    container.innerHTML = products.map(product => `
      <div class="product-item" onclick="viewProduct(${product.id})">
        <div class="product-img">
          ${product.badge ? `<div class="product-badge">${product.badge}</div>` : ''}
          ${product.is_single_item ? '<div class="product-badge" style="left:10px; right:auto; background:linear-gradient(135deg, #ef4444, #dc2626); font-size:8px;">SINGLE ITEM</div>' : ''}
          <span style="font-size:70px;">${product.emoji}</span>
        </div>
        <h4>${product.name}</h4>
        <span class="price">KSh ${product.price.toLocaleString()}</span>
        <button class="btn btn-primary" onclick="event.stopPropagation(); addToCart(${product.id}, '${product.name.replace(/'/g, "\\'")}', ${product.price}, '${product.emoji}', ${product.is_single_item})">
          <span>üõí</span>
          <span>ADD TO CART</span>
        </button>
      </div>
    `).join('');
  }

  // Load stats
  async function loadStats() {
    try {
      const response = await fetch('/api/home-stats/');
      const data = await response.json();
      if (data.success) {
        animateCounter('stat-products', data.stats.total_products);
        animateCounter('stat-customers', data.stats.total_customers);
        animateCounter('stat-satisfaction', data.stats.satisfaction, '%');
      }
    } catch (error) {
      console.error('Error loading stats:', error);
      // Defaults
      animateCounter('stat-products', 1000);
      animateCounter('stat-customers', 50000);
      animateCounter('stat-satisfaction', 98, '%');
    }
  }

  function animateCounter(elementId, target, suffix = '+') {
    const element = document.getElementById(elementId);
    const speed = 200;
    const increment = target / speed;
    let current = 0;

    const updateCount = () => {
      current += increment;
      if (current < target) {
        element.textContent = Math.ceil(current).toLocaleString() + suffix;
        setTimeout(updateCount, 10);
      } else {
        element.textContent = target.toLocaleString() + suffix;
      }
    };
    updateCount();
  }

  // View product details
  function viewProduct(productId) {
    window.location.href = `/products/${productId}/`;
  }



 // Update the addToCart function
// Fixed Add to Cart Function
function addToCart(el) {
  // Get all data attributes from the button
  const productId = el.getAttribute('data-product-id');
  const productName = el.getAttribute('data-product-name');
  const productPrice = parseFloat(el.getAttribute('data-product-price'));
  const productCode = el.getAttribute('data-product-code');
  const productImage = el.getAttribute('data-product-image');
  const maxQuantity = parseInt(el.getAttribute('data-max-quantity')) || 1;
  
  // Check if it's a single item (your HTML doesn't have this attribute, so we'll determine it from category)
  const isSingleItem = maxQuantity === 1;
  
  let selectedQuantity = 1;

  // Prompt for quantity if bulk item
  if (!isSingleItem && maxQuantity > 1) {
    const qty = prompt(`Enter quantity (Max ${maxQuantity}):`, '1');
    if (qty === null) return; // User cancelled
    
    selectedQuantity = parseInt(qty);
    if (isNaN(selectedQuantity) || selectedQuantity < 1) selectedQuantity = 1;
    if (selectedQuantity > maxQuantity) selectedQuantity = maxQuantity;
  }

  // Get current cart from localStorage
  let cart = JSON.parse(localStorage.getItem('fieldmax_cart') || '[]');
  
  // Check if item already exists in cart
  const existingItemIndex = cart.findIndex(item => item.id === parseInt(productId));

  if (existingItemIndex > -1) {
    // Item exists, update quantity
    const newQuantity = cart[existingItemIndex].quantity + selectedQuantity;
    
    // Check if new quantity exceeds max
    if (newQuantity > maxQuantity) {
      showToast(`‚ö†Ô∏è Cannot add more. Maximum quantity (${maxQuantity}) reached.`);
      return;
    }
    
    cart[existingItemIndex].quantity = newQuantity;
    cart[existingItemIndex].subtotal = cart[existingItemIndex].price * newQuantity;
    showToast(`‚úÖ ${productName} quantity updated to ${newQuantity}`);
  } else {
    // New item, add to cart
    cart.push({
      id: parseInt(productId),
      name: productName,
      price: productPrice,
      code: productCode,
      image: productImage,
      quantity: selectedQuantity,
      subtotal: productPrice * selectedQuantity,
      max_quantity: maxQuantity,
      is_single_item: isSingleItem
    });
    showToast(`‚úÖ ${productName} added to cart - KSh ${(productPrice * selectedQuantity).toLocaleString()}`);
  }

  // Save updated cart to localStorage
  localStorage.setItem('fieldmax_cart', JSON.stringify(cart));
  
  // Trigger cart update event to update badge
  window.dispatchEvent(new Event('cartUpdated'));
  
  // Visual feedback on button
  const originalHTML = el.innerHTML;
  el.innerHTML = '<i class="bi bi-check-circle"></i> <span>ADDED!</span>';
  el.style.background = 'linear-gradient(135deg, #10b981, #059669)';
  el.disabled = true;
  
  setTimeout(() => {
    el.innerHTML = originalHTML;
    el.style.background = '';
    el.disabled = false;
  }, 2000);
}

// Toast notification function
function showToast(message) {
  const toast = document.getElementById('toast');
  const toastMessage = document.getElementById('toastMessage');
  
  if (toast && toastMessage) {
    toastMessage.textContent = message;
    toast.classList.add('show');
    
    setTimeout(() => {
      toast.classList.remove('show');
    }, 3000);
  }
}

// Make function globally available
window.addToCart = addToCart;

  // Add click handlers to product cards
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.product-item').forEach(card => {
      card.addEventListener('click', (e) => {
        // Don't navigate if clicking the button
        if (!e.target.closest('.btn-add-cart')) {
          const productId = card.dataset.productId;
          viewProduct(productId);
        }
      });
    });
  });



  // Particle creation
  function createParticles() {
    const container = document.getElementById('particles');
    const count = window.innerWidth < 768 ? 15 : 25;
    for (let i = 0; i < count; i++) {
      const p = document.createElement('div');
      p.className = 'particle';
      p.style.width = (Math.random() * 4 + 2) + 'px';
      p.style.height = p.style.width;
      p.style.left = Math.random() * 100 + '%';
      p.style.top = Math.random() * 100 + '%';
      p.style.animationDelay = Math.random() * 20 + 's';
      p.style.animationDuration = (20 + Math.random() * 15) + 's';
      container.appendChild(p);
    }
  }

  // Event handlers for slideshow
  window.changeSlide = changeSlide;
  window.currentSlide = currentSlide;
  window.addToCart = addToCart;
  window.viewProduct = viewProduct;

  // Video pause when not visible
  if ('IntersectionObserver' in window) {
    const videoObs = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const video = document.querySelector('.video-background video');
        if (video) {
          if (entry.isIntersecting) {
            video.play();
          } else {
            video.pause();
          }
        }
      });
    });
    const videoEl = document.querySelector('.video-background video');
    if (videoEl) videoObs.observe(videoEl);
  }
</script>
{% endblock %}